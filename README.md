# Tesla ä»ªè¡¨æ¿

åŸºäº TeslaMate æ•°æ®çš„ç°ä»£åŒ– Tesla ä»ªè¡¨æ¿ï¼Œä½¿ç”¨ React + Next.js + shadcn/ui æ„å»ºã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ“Š è¡Œç¨‹åˆ—è¡¨å±•ç¤º
- ğŸ—ºï¸ è¡Œç¨‹è¯¦æƒ…å’Œè½¨è¿¹åœ°å›¾ï¼ˆåŸºäºé«˜å¾·åœ°å›¾ï¼‰
- ğŸ“± å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯
- ğŸ¨ ç°ä»£åŒ– UI è®¾è®¡
- âš¡ å¿«é€Ÿæ€§èƒ½

## æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: Next.js 14 (App Router)
- **UI åº“**: shadcn/ui + Tailwind CSS
- **æ•°æ®åº“**: PostgreSQL (TeslaMate)
- **åœ°å›¾æœåŠ¡**: é«˜å¾·åœ°å›¾ API
- **ç¼–ç¨‹è¯­è¨€**: TypeScript

## ç¯å¢ƒè¦æ±‚

- Node.js 18 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ˆä½¿ç”¨ Docker éƒ¨ç½²æ—¶ä¸éœ€è¦æœ¬åœ°å®‰è£…ï¼‰
- TeslaMate å·²éƒ¨ç½²å¹¶è¿è¡Œï¼ˆä½¿ç”¨ Docker éƒ¨ç½²æ—¶ä¼šè‡ªåŠ¨åŒ…å«æ•°æ®åº“ï¼‰
- é«˜å¾·åœ°å›¾ API å¯†é’¥

## å®‰è£…æ­¥éª¤

### 1. å…‹éš†é¡¹ç›®

```bash
git clone <repository-url>
cd tesla-dashboard
```

### 2. å®‰è£…ä¾èµ–

```bash
npm install
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env.local` æ–‡ä»¶å¹¶æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

```env
# æ•°æ®åº“é…ç½® (è¿æ¥åˆ°TeslaMateæ•°æ®åº“)
DB_HOST=your_nas_ip_or_localhost
DB_PORT=5432
DB_NAME=teslamate
DB_USER=teslamate
DB_PASSWORD=your_teslamate_db_password

# é«˜å¾·åœ°å›¾APIé…ç½®
NEXT_PUBLIC_AMAP_KEY=your_amap_api_key
NEXT_PUBLIC_AMAP_SECURITY_CODE=your_amap_security_code
```

### 4. è·å–é«˜å¾·åœ°å›¾ API å¯†é’¥

1. å‰å¾€ [é«˜å¾·å¼€æ”¾å¹³å°](https://lbs.amap.com/)
2. æ³¨å†Œè´¦å·å¹¶åˆ›å»ºåº”ç”¨
3. è·å– `API Key` å’Œ `å®‰å…¨å¯†é’¥`
4. åœ¨åº”ç”¨è®¾ç½®ä¸­æ·»åŠ æ‚¨çš„åŸŸååˆ°ç™½åå•

### 5. è¿è¡Œé¡¹ç›®

```bash
# å¼€å‘æ¨¡å¼
npm run dev

# ç”Ÿäº§æ¨¡å¼
npm run build
npm run start
```

è®¿é—® http://localhost:3000 æŸ¥çœ‹åº”ç”¨ã€‚

### 6. Docker éƒ¨ç½²ï¼ˆæ¨èï¼‰

é¡¹ç›®æ”¯æŒ Docker éƒ¨ç½²ï¼ŒåŒ…å«å®Œæ•´çš„ TeslaMate æ•°æ®åº“ç¯å¢ƒï¼š

```bash
# 1. å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶å¹¶ä¿®æ”¹é…ç½®
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥å®é™…çš„é…ç½®å€¼

# 2. æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# 3. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# 4. åœæ­¢æœåŠ¡
docker-compose down
```

è®¿é—® http://localhost:3333 æŸ¥çœ‹åº”ç”¨ã€‚

## ç›®å½•ç»“æ„

```
tesla-dashboard/
â”œâ”€â”€ app/                    # Next.js App Router é¡µé¢
â”‚   â”œâ”€â”€ layout.tsx         # æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ page.tsx           # é¦–é¡µ (è¡Œç¨‹åˆ—è¡¨)
â”‚   â”œâ”€â”€ trip/[id]/         # è¡Œç¨‹è¯¦æƒ…é¡µ
â”‚   â””â”€â”€ globals.css        # å…¨å±€æ ·å¼
â”œâ”€â”€ components/            # React ç»„ä»¶
â”‚   â”œâ”€â”€ ui/               # shadcn/ui ç»„ä»¶
â”‚   â””â”€â”€ TripMap.tsx       # åœ°å›¾ç»„ä»¶
â”œâ”€â”€ lib/                  # å·¥å…·å‡½æ•°å’Œé…ç½®
â”‚   â”œâ”€â”€ utils.ts          # é€šç”¨å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ database.ts       # æ•°æ®åº“è¿æ¥å’ŒæŸ¥è¯¢
â””â”€â”€ package.json          # é¡¹ç›®é…ç½®
```

## æ•°æ®åº“è¡¨ç»“æ„

åº”ç”¨è¿æ¥åˆ° TeslaMate çš„ PostgreSQL æ•°æ®åº“ï¼Œä¸»è¦ä½¿ç”¨ä»¥ä¸‹è¡¨ï¼š

- `trips`: è¡Œç¨‹æ•°æ®
- `positions`: GPS ä½ç½®æ•°æ®
- `addresses`: åœ°å€ä¿¡æ¯

## è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹åœ°å›¾æ ·å¼

åœ¨ `components/TripMap.tsx` ä¸­ä¿®æ”¹åœ°å›¾æ ·å¼ï¼š

```javascript
mapStyle: 'amap://styles/normal',  // å¯é€‰ï¼šnormal, dark, light ç­‰
```

### ä¿®æ”¹æ•°æ®æ˜¾ç¤ºæ•°é‡

åœ¨ `lib/database.ts` çš„ `getTrips` å‡½æ•°ä¸­ä¿®æ”¹ `LIMIT` å€¼ï¼š

```sql
LIMIT 50  -- ä¿®æ”¹ä¸ºæ‚¨æƒ³è¦çš„æ•°é‡
```

## æ•…éšœæ’é™¤

### æ•°æ®åº“è¿æ¥é—®é¢˜

1. ç¡®è®¤ TeslaMate æ•°æ®åº“æ­£åœ¨è¿è¡Œ
2. æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œé˜²ç«å¢™è®¾ç½®
3. éªŒè¯æ•°æ®åº“å‡­æ®æ˜¯å¦æ­£ç¡®

### åœ°å›¾ä¸æ˜¾ç¤º

1. æ£€æŸ¥é«˜å¾·åœ°å›¾ API å¯†é’¥æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤åŸŸåå·²æ·»åŠ åˆ°é«˜å¾·å¼€æ”¾å¹³å°ç™½åå•
3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯

### ä¾èµ–å®‰è£…é—®é¢˜

```bash
# æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°å®‰è£…
rm -rf node_modules package-lock.json
npm install
```

## å¼€å‘è®¡åˆ’

- [ ] æ·»åŠ å……ç”µè®°å½•å±•ç¤º
- [ ] å®ç°æ•°æ®å¯è§†åŒ–å›¾è¡¨
- [ ] æ·»åŠ è½¦è¾†çŠ¶æ€ç›‘æ§
- [ ] æ”¯æŒå¤šè½¦è¾†åˆ‡æ¢
- [ ] æ·»åŠ æ•°æ®å¯¼å‡ºåŠŸèƒ½

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›é¡¹ç›®ã€‚

## è®¸å¯è¯

MIT License 